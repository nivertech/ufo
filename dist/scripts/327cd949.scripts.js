"use strict";var app=angular.module("ufoApp",["ngCookies","ngResource","ngSanitize","ngRoute","angular-loading-bar","angularMoment"]);app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/history",{templateUrl:"views/history.html",controller:"HistoryCtrl"}).when("/location",{templateUrl:"views/location.html",controller:"LocationCtrl"}).when("/latest",{templateUrl:"views/latest.html",controller:"LatestCtrl"}).otherwise({redirectTo:"/"})}]),app.controller("MainCtrl",["$scope","NUFORCService",function(){}]),angular.module("ufoApp").factory("NUFORCService",["$http",function(a){function b(b){var d=c;return b.forEach(function(a){d+=a+"/"}),a.get(d)}var c="http://nuforc-api.jfproject.me/api/v1/";return{getSightings:function(a){return b(a)}}}]),app.factory("LocationService",["$q","$window","$rootScope",function(a,b,c){return function(){var d=a.defer();return b.navigator?b.navigator.geolocation.getCurrentPosition(function(a){c.$apply(function(){d.resolve(a)})}):d.reject("Geolocation is not supported"),d.promise}}]),app.controller("HistoryCtrl",["$scope","NUFORCService",function(a,b){a.setDate=function(){console.log("yo");var c=["date",a.date.year,a.date.month,a.date.day];b.getSightings(c).success(function(b){a.sightings=b}).error(function(b,c){a.sightings=b||"Error retrieving reported UFO sightings.",a.status=c})}}]),app.controller("LocationCtrl",["$scope","LocationService","GeocodeService","NUFORCService",function(a,b,c,d){a.latitude=null,a.longitude=null,b().then(function(b){a.latitude=b.coords.latitude,a.longitude=b.coords.longitude,c.getAddress(b.coords).success(function(b){var c=b.location;a.state=c.state,a.city=c.city;var e=["location",a.state,a.city];d.getSightings(e).success(function(b){a.sightings=b}).error(function(b,c){a.sightings=b||"Error retrieving reported UFO sightings.",console.log(c)})}).error(function(b,c){a.location=b||"Could not retrieve location information",console.log(c)})}),document.getElementById("zip").addEventListener("keyup",function(b){13==b.keyCode&&(console.log("looking up location"),c.setLocation(a.zip).success(function(b){a.latitude=b.location.lat,a.longitude=b.location.lon,a.state=b.location.state,a.city=b.location.city;var c=["location",a.state,a.city];d.getSightings(c).success(function(b){a.sightings=b}).error(function(b,c){a.sightings=b||"Error retrieving reported UFO sightings.",console.log(c)})}).error(function(b,c){a.location=b||"Could not retrieve location information",console.log(c)}))})}]),app.factory("GeocodeService",["$http",function(a){function b(b){var c=b.latitude,e=b.longitude,f="http://api.wunderground.com/api/"+d;return f+="/geolookup/q/"+c+","+e+".json?callback=JSON_CALLBACK",a.jsonp(f)}function c(b){var c="http://api.wunderground.com/api/"+d;return c+="/geolookup/q/"+b+".json?callback=JSON_CALLBACK",a.jsonp(c)}var d="b41e625badcc567f";return{getAddress:function(a){return b(a)},setLocation:function(a){return c(a)}}}]),app.controller("LatestCtrl",["$scope","NUFORCService",function(a,b){var c=["latest"];b.getSightings(c).success(function(b){a.sightings=b}).error(function(b,c){a.sightings=b||"Error retrieving reported UFO sightings.",a.status=c})}]),app.filter("truncate",function(){return function(a,b,c,d){if(!a)return"";if(c=parseInt(c,10),!c)return a;if(a.length<=c)return a;if(a=a.substr(0,c),b){var e=a.lastIndexOf(" ");-1!=e&&(a=a.substr(0,e))}return a+(d||" â€¦")}}),app.filter("unique",function(){return function(a,b){var c=[],d=[];return angular.forEach(a,function(a){var e=a[b];-1===d.indexOf(e)&&(d.push(e),c.push(a))}),c}});